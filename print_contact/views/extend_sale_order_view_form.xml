<?xml version="1.0"?>

<odoo>
		
	<record id="view_order_form_modifications" model="ir.ui.view">
		<field name="name">modifications formulaire</field>
		<field name="model">sale.order</field>
		<field name="inherit_id" ref="sale.view_order_form"/>
		<field name="arch" type="xml">
			
			<xpath expr="//field[@name='name'][1]" position="after">
				<field name="x_cms_numeroCommande" readonly="1"/>
			</xpath>

			<xpath expr="//field[@name='partner_id']" position="before">
				<field name="x_cms_numeroCommande" required="True"/>  
				<field name="x_cms_filialeEffectuante" required="True"/>  
				<field name="x_cms_nomVendeur"/>   
				<field name="x_cms_controleur"/> 
			</xpath>

			<xpath expr="//field[@name='partner_id']" position="after">
				<field name="x_cms_adresseClient" readonly="1" attrs="{'invisible':[( 'partner_id','=', False )]}" string=""/>
			</xpath>

			<xpath expr="//field[@name='partner_shipping_id']" position="after">
				<field name="x_cms_dateDEnlevement" attrs="{'invisible': [('x_cms_dateDeLivraison', '!=', False )],'required': [('x_cms_dateDeLivraison', '==', False )]}"/>

				<field name="x_cms_filialeAEnlever" readonly="1" attrs="{'invisible': [ ('x_cms_dateDEnlevement', '=', False) ] , 'required':[('x_cms_dateDEnlevement', '!=', False )] }"/>

				<field name="x_cms_dateDeLivraison" attrs="{'invisible': [ ('x_cms_dateDEnlevement', '!=', False ) ],'required': [('x_cms_dateDEnlevement', '==', False )]}"/>

				<field name="x_cms_codePostalLivraison" readonly="0" attrs="{'invisible': [('x_cms_dateDeLivraison', '=', False )]}"/>
				<field name="x_cms_localiteLivraison" readonly="0" attrs="{'invisible': [('x_cms_dateDeLivraison', '=', False )]}"/>
				<field name="x_cms_paysLivraison" readonly="0" attrs="{'invisible': [('x_cms_dateDeLivraison', '=', False )]}"/>
			</xpath>

			<xpath expr="//field[@name='validity_date']" position="before">
				<field name="x_cms_remise"/>
				<field name="x_cms_commentaire"/>
			</xpath>

			<!--	////////////////	-->
  
			<xpath expr="//button[@name='action_confirm'][1]" position="attributes">
				<attribute name="groups">sales_team.group_confirmationDevis</attribute>
			</xpath>

			<xpath expr="//button[@name='action_confirm'][2]" position="attributes">
				<attribute name="groups">sales_team.group_confirmationDevis</attribute>
			</xpath>

			<xpath expr="//field[@name='name']" position="attributes">
				<attribute name="invisible">True</attribute>
			</xpath>

			<xpath expr="//field[@name='partner_id']" position="attributes">
				<attribute name="domain">""</attribute>				
				<attribute name="context">""</attribute>
				<!--
					<attribute name="context">"{'cms_custom_search':True}"</attribute>
				-->
				<attribute name="options">"{&quot;always_reload&quot;: True}"</attribute>
			</xpath>

			<xpath expr="//field[@name='partner_invoice_id']" position="attributes">
				<attribute name="invisible">True</attribute>
			</xpath>

			<xpath expr="//field[@name='partner_shipping_id']" position="attributes">
				<attribute name="invisible">True</attribute>
			</xpath>

			<xpath expr="//field[@name='validity_date']" position="attributes">
				<attribute name="invisible">True</attribute>
			</xpath>

			<xpath expr="//field[@name='confirmation_date']" position="attributes">
				<attribute name="invisible">True</attribute>
			</xpath>

			<xpath expr="//field[@name='pricelist_id']" position="attributes">
				<attribute name="invisible">True</attribute>
			</xpath>

			<xpath expr="//field[@name='currency_id']" position="attributes">
				<attribute name="invisible">True</attribute>
			</xpath>

			<xpath expr="//field[@name='payment_term_id']" position="attributes">
				<attribute name="invisible">True</attribute>
			</xpath>

			<xpath expr="//tree/field[@name='tax_id']" position="attributes">
				<attribute name="invisible">True</attribute>
			</xpath>

			<!--  Page invisible  -->

			<xpath expr="//page[@name='other_information']" position="attributes">
				<attribute name="invisible">True</attribute>
			</xpath>

		</field>
	</record>

	<record id="view_quotation_tree_with_onboarding_modifications" model="ir.ui.view">
		<field name="name">modifications arbre</field>
		<field name="model">sale.order</field>
		<field name="inherit_id" ref="sale.view_quotation_tree_with_onboarding"/>
		<field name="arch" type="xml">

			<xpath expr="//field[@name='name']" position="attributes">
				<attribute name="invisible">True</attribute>
			</xpath>
			
			<xpath expr="//field[@name='partner_id']" position="before">
				<field name="x_cms_numeroCommande"/>
			</xpath>

			<xpath expr="//field[@name='partner_id']" position="after">
				<field name="x_cms_filialeEffectuante"/>
			</xpath>

		</field>
	</record>
	
	<record id="view_quotation_tree_modifications" model="ir.ui.view">
		<field name="name">modifications arbre</field>
		<field name="model">sale.order</field>
		<field name="inherit_id" ref="sale.view_quotation_tree"/>
		<field name="arch" type="xml">

			<xpath expr="//field[@name='name']" position="after">
				<field name="x_cms_numeroCommande"/>
			</xpath>

			<xpath expr="//field[@name='partner_id']" position="after">
				<field name="x_cms_filialeEffectuante"/>
			</xpath>

			<xpath expr="//field[@name='user_id']" position="replace">
				<field name="x_cms_nomVendeur"/>
			</xpath>

			<xpath expr="//field[@name='x_cms_nomVendeur']" position="after">
				<field name="x_cms_dateDEnlevement"/>
				<field name="x_cms_dateDeLivraison"/>
			</xpath>

			<xpath expr="//field[@name='state']" position="after">
				<field name="date_order" position="move"/>
			</xpath>

			<xpath expr="//field[@name='date_order']" position="attributes">
				<attribute name="string">Date de la saisie</attribute>
			</xpath>

		</field>
	</record>
		
	<record id="sale_order_view_search_inherit_quotation_modifications" model="ir.ui.view">
		<field name="name">modifications filtre</field>
		<field name="model">sale.order</field>
		<field name="inherit_id" ref="sale.sale_order_view_search_inherit_quotation"/>
		<field name="arch" type="xml">

			<xpath expr="//filter[@name='my_quotation']" position="replace">

			</xpath>

		</field>
	</record>
		
	<record id="view_form_liste_extend" model="ir.ui.view">
		<field name="name">Boutons pour les différentes listes</field>
		<field name="model">sale.order</field>
		<field name="inherit_id" ref="sale.view_order_form"/>
		<field name="arch" type="xml">

			<xpath expr="//header" position="inside">
				<button name="print_listingDesCommandes" string="Listing des commandes" type="object"/>
				<button name="print_releveDeToutesLesCommandes" string="Relevé de toutes les commandes" type="object"/>
				<button name="print_listeDeProduction" string="Liste de production" type="object"/>
				<button name="print_listeDeProductionFondues" string="Liste de production des fondues" type="object"/>
			</xpath>

		</field>
	</record>	
	
	<record id="view_form_order_line_extend" model="ir.ui.view">
		<field name="name">Extension du One2many order_line </field>
		<field name="model">sale.order</field>
		<field name="inherit_id" ref="sale.view_order_form"/>
		<field name="arch" type="xml">
			
			<xpath expr="//tree/field[@name='product_id']" position="attributes">
				<attribute name="context">"{'partner_id': parent.partner_id,'quantity': product_uom_qty,'pricelist': parent.pricelist_id,'uom':product_uom,'company_id': parent.company_id,'default_lst_price': price_unit,'default_description_sale': name,'cms_search_code':True}"</attribute>
				<attribute name="options">{'no_create': True,'no_create_edit':True}</attribute>
			</xpath>
			
			<xpath expr="//tree/field[@name='product_uom']" position="before">
				<field name="x_cms_unitee" readonly="False" required="True" domain="[('name','not in',['Douzaine(s)','Heure(s)','Jour(s)','cm','fl oz','gal(s)','km','lb(s)','m','mile(s)','oz(s)','pied (ft)','pouce(s)','qt','t'])]"/>
			</xpath>
			
			<xpath expr="//tree/field[@name='price_subtotal']" position="after">
				<field name="x_cms_annule" readonly="False"/>
			    <field name="x_cms_commentaireArticle"/>
				<field name="x_cms_sauce"/>
			</xpath>
			
		</field>
	</record>
	
	<record id="view_sales_order_filter_custom" model="ir.ui.view">
		<field name="name">sale.order.list.select.custom</field>
		<field name="model">sale.order</field>
		<field name="inherit_id" ref="sale.view_sales_order_filter"/>
		<field name="arch" type="xml">
			<xpath expr="//search/field[@name='name']" position="replace">
                <field name="name" string="Sales Order" filter_domain="['|','|','|',('name','ilike',self),('client_order_ref','ilike',self),('partner_id','child_of',self),('x_cms_numeroCommande', 'ilike', self)]"/>
			</xpath>
			
			<xpath expr="//search/filter[@name='activities_upcoming_all']" position="after">
				<separator/>				
				
				<!-- Inclue les fondues/pierrades annulées -->
				<filter string="Fondue bourguignonne coupée" name="fonduebourguignonnecoupee"
                        domain="[('confirmee_fb', '=', True),('entiere_fb','=',False)]"
                        help="Filtrer les fondues bourguignonne entières confirmées"/>
						
				<filter string="Fondue bourguignonne entière" name="fonduebourguignonneentiere"
                        domain="[('confirmee_fb', '=', True),('entiere_fb','=',True)]"
                        help="Filtrer les fondues bourguignonne entières confirmées"/>
				
				<filter string="Fondue chinoise coupée" name="fonduechinoisecoupee"
                        domain="[('confirmee_fc', '=', True),('entiere_fc','=',False)]"
                        help="Filtrer les fondues chinoises coupées confirmées"/>
						
				<filter string="Fondue chinoise entière" name="fonduechinoiseentiere"
                        domain="[('confirmee_fc', '=', True),('entiere_fc','=',True)]"
                        help="Filtrer les fondues chinoises entières confirmées"/>
						
				<filter string="Pierrade coupée" name="pierradecoupee"
                        domain="[('confirmee_pr', '=', True),('entiere_pr','=',False)]"
                        help="Filtrer les pierrades coupées confirmées"/>
				
				<filter string="Pierrade entière" name="pierradeentiere"
                        domain="[('confirmee_pr', '=', True),('entiere_pr','=',True)]"
                        help="Filtrer les pierrades entières confirmées"/>
				
				<filter string="Pierrade marinée coupée" name="pierrademarineecoupee"
                        domain="[('confirmee_prm', '=', True),('entiere_prm','=',False)]"
                        help="Filtrer les pierrades marinées coupées confirmées"/>
				
				<filter string="Pierrade marinée entière" name="pierrademarineeentiere"
                        domain="[('confirmee_prm', '=', True),('entiere_prm','=',True)]"
                        help="Filtrer les pierrades marinées entières confirmées"/>
						
				<separator/>				
			</xpath>
	
			<xpath expr="//search/group" position="inside">
				<filter string="Filiales" name="Filiales" domain="[]" context="{'group_by':'x_cms_filialeEffectuante'}"/>
			</xpath>
		</field>
	</record>
	
</odoo>
